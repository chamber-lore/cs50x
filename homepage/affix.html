<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        <link href="styles.css" rel="stylesheet">
        <title>The Chamber of Lore: Affix</title>
    </head>
    <body>
        <script>
            window.addEventListener("DOMContentLoaded", function() {
                let form = document.querySelector("form");
                form.addEventListener("submit", function() {
                    let hex = document.querySelector("#hex").value;
                    let url = "https://corsproxy.io/?https://colornames.org/search/json/?hex="
                    let nurl = url.concat(hex.toString().replace("#", ""));
                    let has_name = document.querySelector("#name").checked;
                    document.body.style.backgroundColor = hex;
                    var xmlhttp = new XMLHttpRequest();
                    xmlhttp.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200) {
                            let response = JSON.parse(this.responseText);
                            let alert_first = "Somehow, the color doesn't have a name. You should contribute one! "
                            let alert_second = "As for your guess, it was incorrect. Sorry, nbd though!"
                            let had_name = false;
                            if (response.name)
                            {
                                had_name = true;
                                alert("The color has a name! It's " + response.name);
                            }
                            else
                            {
                                alert("The color doesn't have a name. You should contribute one!");
                            }
                            if (had_name == has_name)
                            {
                                alert("You guessed correctly! Well done :)");
                            }
                            else
                            {
                                alert("You guessed incorrectly, but nbd! There are about 16.7 million others to try your luck against.");
                            }
                        }
                    };
                    xmlhttp.open("GET", nurl, true);
                    xmlhttp.send();
                });
            });
        </script>
        <header class="container-fluid">
            <h1 class="h1">Welcome to affix!</h1>
        </header>
        <div class="container text-center" style="background-color: darkgrey;">
            <form id="quiz" action="javascript:void(0);">
                <label for="hex">Pick an RGB color: </label>
                <input type="color" id="hex">
                <br>
                <label for="name">Do you think this color has a name (according to colornames.org)? </label>
                <input type="checkbox" id="name">
                <br>
                <input type="submit">
            </form>
        </div>
        <footer class="container-fluid">
            Navigate back to the
             <a href="index.html">index</a>
        </footer>
    </body>
</html>
